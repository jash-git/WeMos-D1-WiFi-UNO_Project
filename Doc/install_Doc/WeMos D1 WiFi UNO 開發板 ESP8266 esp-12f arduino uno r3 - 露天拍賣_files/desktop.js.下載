!function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}({0:function(e,t,r){window.RT=window.RT||{},RT.App=$.extend({},Box.Application),r("./d/components/rt_header.js"),RT.footer&&$(".mobile").css("display","inline-block"),$(document).ready(function(){RT.App.init({debug:!0}),$("body").on("click","[_xhref]",function(e){e.preventDefault();var t=document.createElement("a");t.href=e.currentTarget.getAttribute("_xhref"),t.target=e.currentTarget.getAttribute("target"),e.delegateTarget.appendChild(t),t.click(),e.delegateTarget.removeChild(t)})})},"./d/components/rt_header.js":function(e,t,r){r("./services/AjaxHeaderDataService.js"),r("./services/DetectIEService.js"),RT.App.addModule("rt-header",function(e){"use strict";var t,r=e.getService("DetectIEService"),n=e.getService("AjaxHeaderDataService"),i=($(e.getElement()),500),a=["is-loaded","is-not-loaded","is-loading"],o=$("#header_login_info"),c=$("#header_user_nick"),s=$("#last_login_time"),u=$("#header_good_credit");return{init:function(){this.render(n.getData())},destroy:function(){o=null,c=null,s=null,u=null,t=null},onclick:function(e,t,r){"submit-button"===r?this.composeAndSubmitForm():"logout-link"===r&&this.clearStoredUserData()},onkeyup:function(e,t,r){"keyword-input"===r&&13===e.which&&(e.preventDefault(),this.composeAndSubmitForm())},render:function(e){var r=this;t=t||(new Date).getTime(),e?$.isFunction(e.then)?(r.toggleHeaderState("loading"),e.done(function(e){var n=(new Date).getTime()-t;n<i?setTimeout(function(){r.render(e)},i-n):(t=null,r.renderHeaderUserData(e),r.toggleHeaderState("loaded"))}).fail(function(){r.toggleHeaderState("not-loaded")})):(t=null,r.renderHeaderUserData(e),r.toggleHeaderState("loaded")):r.toggleHeaderState("not-loaded")},toggleHeaderState:function(e,t){var r="is-"+e;t=t||(a?a:[]),o.removeClass(function(){return t.filter(function(e){return e!==r}).join(" ")}).addClass(r)},renderHeaderUserData:function(e){if(e&&e.user_nick){var t=RT.config.mybid_host||"https://mybid.ruten.com.tw",r=new Date(1e3*e.last_login_time);c.text(e.user_nick),c.attr("href",t+"/user/"+e.user_nick),u.text(e.good_credit),u.attr("href",t+"/credit/point?"+e.user_nick),s.length&&(s.text(r.getFullYear()+"/"+(r.getMonth()+1)+"/"+r.getDate()+" "+r.getHours()+":"+r.getMinutes()),s.css({color:e.last_login_check?"#4b4a4a":"#e24507","font-size":"10px"}).on("click",function(){return window.open(t+"/master/my_login.htm","query_login","resizable=yes,scrollbars=yes,width=660,height=558"),!1}))}},composeAndSubmitForm:function(){var e=RT.config.search_host||"http://search.ruten.com.tw",t=$(".rt-search-form"),n=$("#search_type"),i=$("#search_seller_user_nick"),a=$("#search_g_class"),o="utf-8";n.length&&("seller"===n.val()?(t.append('<input type="hidden" name="s" value="'+i.val()+'">'),t.attr("action",e+"/search/ulist00.php"),o="big5"):"class"===n.val()&&t.append('<input type="hidden" name="c" value="'+a.val()+'">')),r.isIE()&&(document.charset=o),t.attr("accept-charset",o),t.submit()},clearStoredUserData:function(){n.resetData()}}})},"./services/AjaxHeaderDataService.js":function(e,t){RT.App.addService("AjaxHeaderDataService",function(e){"use strict";function t(){return n=a.retrieve(),n?n:r()}function r(){var e=$.Deferred(),t=RT.config&&RT.config.member_host||"https://member.ruten.com.tw";return i=!0,$.ajax({url:t+"/user/ajax_header_slice.php",dataType:"json",xhrFields:{withCredentials:!0},success:function(t){t?(a.save(t),e.resolve(t)):e.reject()},error:function(t,r,n){e.reject(r)},complete:function(){i=!1}}),e}var n={},i=!1,a=e.getService("HeaderDataStorageService");return{getData:function(e){var r=this;if(i)return e=e||$.Deferred(),setTimeout(function(){r.getData(e)},100),e;if(e){var n=t();n?$.isFunction(n.then)?n.done(e.resolve).fail(e.reject):e.resolve(n):e.reject()}return t()},resetData:function(){a.reset()}}}),RT.App.addService("HeaderDataStorageService",function(e){"use strict";function t(){var e=Cookies.get(o,{domain:c});return e&&a(e)}function r(e){var t=new Date;t.setMinutes(t.getMinutes()+3),e=i(e),Cookies.set(o,e,{domain:c,expires:t})}function n(){Cookies.remove(o,{domain:c})}function i(e){return window.btoa(JSON.stringify(e))}function a(e){return JSON.parse(window.atob(e))}var o="rt_header_info",c="ruten.com.tw",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return window.btoa||(window.btoa=function(e){for(var t,r="",n=-6,i=0,a=0,o=0;a<e.length||n>-6;)0>n&&(a<e.length?(t=e.charCodeAt(a++),o+=8):t=0,i=(255&i)<<8|255&t,n+=8),r+=s.charAt(o>0?i>>n&63:64),n-=6,o-=6;return r},window.atob=function(e){for(var t,r,n="",i=-8,a=0,o=0;o<e.length;o++)(t=s.indexOf(e.charAt(o)))<0||(a=a<<6|63&t,(i+=6)>=0&&(r=a>>i&255,64!=t&&(n+=String.fromCharCode(r)),a&=63,i-=8));return n}),{retrieve:function(){return t()},save:function(e){r(e)},reset:function(){n()}}})},"./services/DetectIEService.js":function(e,t){RT.App.addService("DetectIEService",function(e){"use strict";function t(e){var t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var r=e.indexOf("Trident/");if(r>0){var n=e.indexOf("rv:");return parseInt(e.substring(n+3,e.indexOf(".",n)),10)}var i=e.indexOf("Edge/");return i>0&&parseInt(e.substring(i+5,e.indexOf(".",i)),10)}var r=window.navigator.userAgent;return{isIE:function(){return!!t(r)},getVersion:function(){return t(r)},detectIE:function(e){return t(e)}}})}});