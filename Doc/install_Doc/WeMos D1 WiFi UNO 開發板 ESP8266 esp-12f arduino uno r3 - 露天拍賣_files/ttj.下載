(function(){function e(e,t){return typeof __an_obj_extend_thunk=="function"?__an_obj_extend_thunk(e,t):e}function t(e,t){typeof __an_err_thunk=="function"&&__an_err_thunk(e,t)}function n(e,t){if(typeof __an_redirect_thunk=="function")__an_redirect_thunk(e);else{var n=navigator.connection;navigator.__an_connection&&(n=navigator.__an_connection),window==window.top&&n&&n.downlinkMax<=.115&&typeof HTMLIFrameElement=="function"&&HTMLIFrameElement.prototype.hasOwnProperty("srcdoc")?(window.__an_resize=function(e,t,n){var r=e.frameElement;r&&r.getAttribute("name")=="__an_if"&&(t&&(r.style.width=t+"px"),n&&(r.style.height=n+"px"))},document.write('<iframe name="__an_if" style="width:0;height:0" srcdoc="<script type=\'text/javascript\' src=\''+e+"&"+t.bdfif+"=1'></sc"),document.write('ript>" frameborder="0" scrolling="no" marginheight=0 marginwidth=0 topmargin="0" leftmargin="0" allowtransparency="true"></iframe>')):document.write('<script language="javascript" src="'+e+'"></'+"script>")}};var r=function(e){this.rdParams=e};r.prototype={constructor:r,walkAncestors:function(e){try{if(!window.location.ancestorOrigins)return;for(var t=0,n=window.location.ancestorOrigins.length;t<n;t++)e.call(null,window.location.ancestorOrigins[t],t)}catch(r){typeof console!="undefined"&&console.log(r)}return[]},walkUpWindows:function(e){var t=[],n;do try{n=n?n.parent:window,e.call(null,n,t)}catch(r){return typeof console!="undefined"&&console.log(r),t.push({referrer:null,location:null,isTop:!1}),t}while(n!=window.top);return t},getPubUrlStack:function(e){var n=[],r=null,i=null,s=null,o=null,u=null,a=null,f=null,l;for(l=e.length-1;l>=0;l--){try{s=e[l].location}catch(c){typeof console!="undefined"&&console.log(c),t(c,"AnRDModule::getPubUrlStack:: location")}if(s)i=encodeURIComponent(s),n.push(i),f||(f=i);else if(l!==0){o=e[l-1];try{u=o.referrer,a=o.ancestor}catch(c){typeof console!="undefined"&&console.log(c),t(c,"AnRDModule::getPubUrlStack:: prevFrame")}u?(i=encodeURIComponent(u),n.push(i),f||(f=i)):a?(i=encodeURIComponent(a),n.push(i),f||(f=i)):n.push(r)}else n.push(r)}return{stack:n,detectUrl:f}},getLevels:function(){var e=this.walkUpWindows(function(e,n){try{n.push({referrer:e.document.referrer||null,location:e.location.href||null,isTop:e==window.top})}catch(r){n.push({referrer:null,location:null,isTop:e==window.top}),typeof console!="undefined"&&console.log(r),t(r,"AnRDModule::getLevels")}});return this.walkAncestors(function(t,n){e[n].ancestor=t}),e},getRefererInfo:function(){var e="";try{var n=this.getLevels(),r=n.length-1,i=n[r].location!==null||r>0&&n[r-1].referrer!==null,s=this.getPubUrlStack(n);e=this.rdParams.rdRef+"="+s.detectUrl+"&"+this.rdParams.rdTop+"="+i+"&"+this.rdParams.rdIfs+"="+r+"&"+this.rdParams.rdStk+"="+s.stack+"&"+this.rdParams.rdQs}catch(o){e="",typeof console!="undefined"&&console.log("AnRDModule::getRefererInfo: error occured: %s",o),t(o,"AnRDModule::getRefererInfo")}return e}};var i=function(n){var i="";try{n=e(n,0);var s=e(new r(n),1);return s.getRefererInfo()}catch(o){i="",typeof console!="undefined"&&console.log("executeRD: error occured: %s",o),t(o,"AnRDModule::executeRD")}return i};;var s=function(e){e=e?e:{};var t={};t.idsStaleMs="idsStaleSec"in e?1e3*e.idsStaleSec:0,t.criBidderId="criBidderId"in e?e.criBidderId:"0",t.criId="criId"in e?e.criId:"0",t.ids=e.ids,t.criteoFun=e.criteoFun,this.params=t,typeof console!="undefined"&&console.log("AnSync3rdParty::ctor: using params: ",this.params)};s.prototype={constructor:s,Util:{Base64:{keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=this.utf8Encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+this.keyStr.charAt(s)+this.keyStr.charAt(o)+this.keyStr.charAt(u)+this.keyStr.charAt(a);return t},decode:function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=this.keyStr.indexOf(e.charAt(f++)),o=this.keyStr.indexOf(e.charAt(f++)),u=this.keyStr.indexOf(e.charAt(f++)),a=this.keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=this.utf8Decode(t),t},utf8Encode:function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},utf8Decode:function(e){var t="",n=0,r=0,i=0,s=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|i&63),n+=2):(i=e.charCodeAt(n+1),s=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63),n+=3);return t}}},getStg:function(e){var n=null;try{window.sessionStorage&&(n=window.sessionStorage.getItem(e)),!n&&window.localStorage&&(n=window.localStorage.getItem(e))}catch(r){typeof console!="undefined"&&console.log("AnSync3rdParty::getStg: storage not available (error: %s)",r),t(r,"AnSync3rdParty::getStg")}return n},setStg:function(e,n){try{window.sessionStorage&&window.sessionStorage.setItem(e,n),window.localStorage&&window.localStorage.setItem(e,n)}catch(r){typeof console!="undefined"&&console.log("AnSync3rdParty::setStg: storage not available (error: %s)",r),t(r,"AnSync3rdParty::setStg")}},getCachedIds:function(e){var n=this.getStg("__ansync3rdp_"+e);if(n)try{n=JSON.parse(this.Util.Base64.decode(n))}catch(r){n=null,typeof console!="undefined"&&console.log("AnSync3rdParty::getCachedIds: failed to deserialize __ansync3rdp_%s: [%s]: error: %s",e,n,r),t(r,"AnSync3rdParty::getCachedIds")}return n},getCachedIdsEnc:function(){var e=this.getCachedIds(this.params.criBidderId),n=null;try{e&&e.uCode?(n={tpuids:[{provider:e.bId,user_id:e.uCode}]},n=this.Util.Base64.encode(JSON.stringify(n))):n=null}catch(r){n=null,typeof console!="undefined"&&console.log("AnSync3rdParty::getCachedIds: error encoding ids: %s",r),t(r,"AnSync3rdParty::getCachedIdsEnc")}return n},setCachedIds:function(e,n){var r=null;try{r={bId:e,uCode:n,ts:(new Date).getTime()},r=this.Util.Base64.encode(JSON.stringify(r))}catch(i){typeof console!="undefined"&&console.log("AnSync3rdParty::setCachedIds: error encoding ids: %s",i),t(i,"AnSync3rdParty::setCachedIds")}this.setStg("__ansync3rdp_"+e,r)},isStaleCachedIds:function(e){var n=!0;if(e&&(typeof e.ts=="string"||typeof e.ts=="number"))try{var r=new Date-new Date(e.ts);n=isNaN(r)||r>this.params.idsStaleMs,typeof console!="undefined"&&console.log("AnSync3rdParty::isStaleCachedIds: last update %s(ms) ago, stale:%s",r,n)}catch(i){n=!0,typeof console!="undefined"&&console.log("AnSync3rdParty::isStaleCachedIds: error checking stale timestamp [%s]: %s",e.ts,i),t(i,"AnSync3rdParty::isStaleCachedIds")}return n},criteoMakeSyncCb:function(){var e=this;return function(t){typeof console!="undefined"&&console.log("AnSync3rdParty::criteoMakeSyncCb: storing criteo sync data, criBidderId:[%s]...",e.params.criBidderId),e.setCachedIds(e.params.criBidderId,typeof t.userid=="string"&&t.userid!==""?t.userid:null)}},criteoSchdAsync:function(e,t){typeof console!="undefined"&&console.log("AnSync3rdParty::criteoSchdAsync: initiating sync..."),window[e]=t;var n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://gum.criteo.com/sync?c="+this.params.criId+"&r=2&j="+e;var r=document.getElementsByTagName("head")||document.getElementsByTagName("body");r&&r[0]&&r[0].appendChild(n)},sync:function(){var e=this.getCachedIds(this.params.criBidderId);this.isStaleCachedIds(e)&&this.criteoSchdAsync(this.params.criteoFun,this.criteoMakeSyncCb());var t=this.getCachedIdsEnc();return u=t?this.params.ids+"="+t:"",u}};var o=function(n){var r="";try{n=e(n,2);var i=e(new s(n),3);r=i.sync()}catch(o){r="",typeof console!="undefined"&&console.log("executeSync: error occured: %s",o),t(o,"AnSync3rdParty::executeSync")}return r};;var u="https://secure.adnxs.com/ttj?ttjb=1&bdc=1493773113&bdh=bqq1uZ2SSbfGEbDioSv3lpNzwAM.";u+="&"+o({idsStaleSec:600,criBidderId:"criteo",criId:"30",ids:"tpuids",criteoFun:"cr_handle_data_a"}),u+="&"+i({rdRef:"bdref",rdTop:"bdtop",rdIfs:"bdifs",rdStk:"bstk",rdQs:"&id=9471680&cb=636293986583178840&pt1=lQgNGg88RCNICgxsUmtaQWdZd1JpOU8QohIYGCDLYjIECFUYCDoDCLRCQgMIrBtI4KQKUgtQaWMyMF9YYXhpc1iV1PSXp8Ck6ghiBE4wMjhqF0NYUjIwMTcwNDE3MDgyMjA5NzQ5OTczcB56AlBDggEiMDE4MzAwNTk3ZDliMmZlNzExODBiOTFjODcyYzczMzVkMw&pubclick=http://money.scupio.com/adpinline/click.aspx?ToURL=DummyURL_MediaMind&AdID=168544&PubID=lRkZAgYwRi9O&Mode=Pic20_Xaxis&SubMode=&OrgKey=CXR20170417082209749973&CID=12619&EID=636293986582866453&I=lVpURk1sFHcNFlVARFNZ&u=http%3a%2f%2fgoods.ruten.com.tw%2fitem%2fshow%3f21643123498036&wid=2338,24&adt=30,0&cp=&AdOrder=0&ES=lSVcRFs%3d&callid=018300597d9b2fe71180b91c872c7335d3&redirect=6&clickrange=picad"}),n(u,{bdfif:"bdfif"})})();